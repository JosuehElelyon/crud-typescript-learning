import { User, CreateUserDTO, UpdateUserDTO } from '../models/User';\nimport { runQuery, getQuery, allQuery } from '../database/connection';\n\nclass UserRepository {\n  // CREATE - Criar um novo usuário\n  async create(userData: CreateUserDTO): Promise<User> {\n    const { name, email, age } = userData;\n    \n    await runQuery(\n      'INSERT INTO users (name, email, age) VALUES (?, ?, ?)',\n      [name, email, age]\n    );\n\n    const user = await getQuery<User>(\n      'SELECT * FROM users WHERE email = ?',\n      [email]\n    );\n\n    if (!user) {\n      throw new Error('Erro ao criar usuário');\n    }\n\n    return user;\n  }\n\n  // READ - Buscar todos os usuários\n  async findAll(): Promise<User[]> {\n    return await allQuery<User>('SELECT * FROM users ORDER BY created_at DESC');\n  }\n\n  // READ - Buscar usuário por ID\n  async findById(id: number): Promise<User | undefined> {\n    return await getQuery<User>('SELECT * FROM users WHERE id = ?', [id]);\n  }\n\n  // READ - Buscar usuário por email\n  async findByEmail(email: string): Promise<User | undefined> {\n    return await getQuery<User>('SELECT * FROM users WHERE email = ?', [email]);\n  }\n\n  // UPDATE - Atualizar usuário\n  async update(id: number, userData: UpdateUserDTO): Promise<User | undefined> {\n    const user = await this.findById(id);\n    if (!user) return undefined;\n\n    const updates: string[] = [];\n    const values: any[] = [];\n\n    if (userData.name !== undefined) {\n      updates.push('name = ?');\n      values.push(userData.name);\n    }\n    if (userData.email !== undefined) {\n      updates.push('email = ?');\n      values.push(userData.email);\n    }\n    if (userData.age !== undefined) {\n      updates.push('age = ?');\n      values.push(userData.age);\n    }\n\n    if (updates.length === 0) return user;\n\n    values.push(id);\n    await runQuery(\n      `UPDATE users SET ${updates.join(', ')} WHERE id = ?`,\n      values\n    );\n\n    return await this.findById(id);\n  }\n\n  // DELETE - Deletar usuário\n  async delete(id: number): Promise<boolean> {\n    const user = await this.findById(id);\n    if (!user) return false;\n\n    await runQuery('DELETE FROM users WHERE id = ?', [id]);\n    return true;\n  }\n}\n\nexport default new UserRepository();\n